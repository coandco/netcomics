#-*-Perl-*-

#Add the name of the subroutines to the hash of functions
#with the number of days from today the comic is available
$hof{"superstep"} = 0;

#Supernormal Step http://supernormalstep.com
sub superstep {
    my $time = shift;
    my @ltime = gmtime($time);
    my @monthconv = ("Jan", "Feb", "Mar", "Apr", "May", "June",
                     "Jul", "Aug", "Sep", "Oct", "Nov", "Dec");

    my $monthname = $monthconv[$ltime[4]];
    my $datestr = strftime("$monthname.%d.%y",@ltime);

    my $base = "http://www.supernormalstep.com";

    my $rec = {
        'title' => "Supernormal Step",
        'author' => "Michael Lee Lunsford",
        'type' => 'jpg',
        'main' => "$base/",
        'archives' => "$base/archives/archive",
        'base' => "",
        'page' => "$base/archives/archive"
        };

    $rec->{'func'} = sub {
        my $text = shift;
        my @update = ();
        my $update = {};
        if ($text =~ s/option value="([^"]*)">$datestr//i) {
            my $arcid = $1;
            push @update, {
                'page' => "$base/archives/$arcid",
                'func' => sub {
                    my $newtext = shift;
                    my @relurls = ();
                    if ($newtext =~ s/src="([^"]*)" id="cc-comic"//i) {
                        my $file = $1;
                        push(@relurls, $file);
                    }
                    return @relurls;
                }
            };
        }
        return @update;
    };


    return $rec;
}

1;
